#----------------------------#
# santasearch configuration  #
#--------------------------------------------------#
# Elasticsearch (compatibility with nuclei)        #
# See: issue-tracker-config.yaml                   #
# https://github.com/projectdiscovery/nuclei       #
#--------------------------------------------------#
elasticsearch:
  # IP for elasticsearch instance
  ip: 127.0.0.1
  # Port is the port of elasticsearch instance
  port: 9200
  # SSL enables ssl for elasticsearch connection
  ssl: false
  # SSLVerification disables SSL verification for elasticsearch
  ssl-verification: false
  # Username for the elasticsearch instance
  username: elastic
  # Password is the password for elasticsearch instance
  password: changeme
  # nuclei elasticsearch index name
  index-name: nuclei
######################################################
#---------------------------#
# Tools and ES json queries #
#- -------------------------#
sc_tools: {
   nmap: {
     "_esindex": "nmap",
     "_esquery": {
         "query": {
           "bool": {
             "must": [],
           }
         },
         "_source": {"includes": ["time","ip","port","protocol","script","script_output"]},
         "size": 100,
         "sort": [{"time": "asc" }]
       }
   },

   httpx: {
     "_esindex": "nmap",
     "_esquery": {
         "query": {
           "bool": {
             "must": [{"match": {"script": "httpx"}}],
             "filter": [{"exists": {"field": "script_output"}}]
           }
         },
         "_source": {"includes": ["time","ip","script","script_output"]},
         "size": 100,
         "sort": [{"time": "asc" }]
       }
   },

   nuclei: {
     "_esindex": "nuclei",
     "_esquery": {
         "query": {
           "bool": {
             "must": [],
           }
         },
         "_source": {
         "includes": ["@timestamp", "event.ip", "event.info.severity",
                      "event.info.name", "event.matched-at", "event.template-id",
                      "event.info.classification.cvss-score", "event.info.description"]
         },
         "size": 100,
         "sort": [{"@timestamp": "asc"}]
       }
   }
}
